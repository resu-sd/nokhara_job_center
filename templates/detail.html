{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Job Detail</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <style>
      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        font-family: Arial, sans-serif;
        background-color: #f4f6f8;
      }

      main {
        flex: 1;
      }

      .container-detail {
        display: flex;
        max-width: 1200px;
        margin: 120px auto 20px auto; /* 120px to avoid overlapping with fixed navbar */
        gap: 20px;
      }

      .job-detail {
        flex: 2;
        background-color: #ffffff;
        padding: 25px;
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }

      .job-detail h2 {
        margin-bottom: 5px;
        color: #333;
      }

      .company {
        color: #666;
        font-style: italic;
        margin-bottom: 20px;
      }

      .job-meta {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px 20px;
        background: #f9f9f9;
        padding: 15px;
        border-radius: 6px;
        margin-bottom: 20px;
      }

      .job-meta p {
        margin: 0;
        font-size: 14px;
        color: #333;
      }
      .job-meta span {
        font-weight: bold;
        color: #364496ff;
      }

      .job-info h3 {
        margin-top: 20px;
        margin-bottom: 10px;
        color: #364496ff;
        padding-bottom: 5px;
        border-bottom: 1px solid #ededed;
      }

      .job-info ul {
        margin-left: 20px;
        margin-bottom: 15px;
      }

      .apply-btn {
        background-color: #28a745;
        color: white;
        padding: 10px 22px;
        border: none;
        border-radius: 6px;
        font-size: 15px;
        cursor: pointer;
      }

      .apply-btn:hover {
        background-color: #218838;
      }
    </style>
  </head>

  <body>
    {% include 'nav.html' %}

    <main>
      <div class="container-detail">
        <section class="job-detail">
          <h2>{{ job.title }}</h2>

          <div class="job-meta">
            <p><span>Location:</span> {{ job.location }}</p>
            <p><span>Salary Range:</span> {{ job.salary_range }}</p>
            <p><span>Status:</span> {{ job.job_type }}</p>
            <p><span>Published Date:</span> {{ job.created_at|date:"Y-m-d" }}</p>
            <p><span>Expiry Date:</span> {{ job.expiry_date|date:"Y-m-d" }}</p>
            <p><span>Created By:</span> {{ job.created_by.username }}</p>
          </div>

          <div class="job-info">
            <h3>Job Description</h3>
            <p>
              {{ job.description }}
            </p>

            <h3>Requirements</h3>
            <ul>
              {% for req in requirements %}
              <li>{{ req.text }}</li>
              {% empty %}
              <li>No requirements listed.</li>
              {% endfor %}
          </ul>

            <h3>Benefits</h3>
            <ul>
              {% for ben in benefits %}
              <li>{{ ben.text }}</li>
              {% empty %}
              <li>No benefits listed.</li>
              {% endfor %}
          </ul>

            <button
              type="button"
              class="apply-btn"
              data-bs-toggle="modal"
              data-bs-target="#applyFormModal"
            >
              Apply Now
            </button>
          </div>
        </section>
      </div>
    </main>

    <div
      class="modal fade"
      id="applyFormModal"
      tabindex="-1"
      aria-labelledby="applyFormModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="applyFormModalLabel">
              Apply for Job
            </h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <form id="applyForm">
            <div class="modal-body">
              <div class="mb-3">
                <label for="name" class="form-label">Full Name</label>
                <input type="text" class="form-control" id="name" required />
              </div>
              <div class="mb-3">
                <label for="email" class="form-label">Email Address</label>
                <input type="email" class="form-control" id="email" required />
              </div>
              
              <div class="mb-3">
                <label for="address" class="form-label">Address</label>
                <textarea
                  class="form-control"
                  id="address"
                  rows="2"
                  required
                ></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button type="submit" class="btn btn-success">
                Submit Application
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="successModal"
      tabindex="-1"
      aria-labelledby="successModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="successModalLabel">
              Application Sent!
            </h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>Your application has been successfully sent.</p>
            <p>Please visit the office or wait for a call.</p>

            <p><strong>Location:</strong> Sanepa, Kathmandu</p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-primary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      document
        .getElementById("applyForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          const applyModal = bootstrap.Modal.getInstance(
            document.getElementById("applyFormModal")
          );
          applyModal.hide();
          const successModal = new bootstrap.Modal(
            document.getElementById("successModal")
          );
          successModal.show();
          this.reset();
        });
    </script>

    {% include 'footer.html' %}
  </body>
</html>
